(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-71f32490"],{"2ffc":function(t,e,a){},"988a":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"p-15"},[a("div",{staticClass:"catalogue"},[a("img",{staticClass:"thumb",attrs:{src:t.detail.image,alt:""}}),a("div",{staticClass:"title"},[a("div",{staticClass:"fz-16 c3"},[t._v(t._s(t.detail.name))]),a("div",{staticClass:"fz-16 text-price"},[t._v("¥"+t._s(t.detail.bug_info.price))])])]),a("ul",{staticClass:"cell-group"},[t._m(0),a("li",{staticClass:"cell"},[a("div",{staticClass:"cell__title"},[t._v("商品金额")]),a("div",{staticClass:"cell__value"},[t._v("￥"+t._s(t.detail.bug_info.price))])])]),a("van-popup",{attrs:{round:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"xieyi-box"},[a("div",{staticClass:"title"},[t._v("购买协议")]),a("div",{staticClass:"content-box"},[a("div",{staticClass:"mb-10 fz-15 c6",domProps:{innerHTML:t._s(t.UPGRADE_SERVICE_AGREEMENT.value)}}),a("div",{staticClass:"flex flex-align-center"},[a("div",{staticClass:"checked",class:t.flag?"on":"",on:{click:function(e){t.flag=!t.flag}}}),a("div",{staticClass:"fz-14 c9"},[t._v("\n            同意并阅读\n            "),a("span",{staticClass:"text-primary"},[t._v("《购买协议》")])])])]),a("div",{staticClass:"btns"},[a("div",{staticClass:"btn-o",on:{click:function(e){t.show=!1}}},[t._v("关闭")]),a("div",{staticClass:"btn",class:t.flag?"":"disable",on:{click:t.confirmXY}},[t._v("确定")])])])]),a("footer",{staticClass:"footer-bar flex flex-align-center"},[t._m(1),a("div",{staticClass:"price"},[a("span",{staticClass:"fz-15 text-price fw-700"},[t._v("¥"+t._s(t._f("toF")(t.detail.bug_info.price)))])]),a("div",{staticClass:"btn-youya",on:{click:t.confim}},[t._v("去支付")])])],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"cell"},[a("div",{staticClass:"cell__title"},[t._v("支付方式")]),a("div",{staticClass:"cell__value"},[t._v("微信支付")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tips"},[a("span",{staticClass:"text-price"},[t._v("*")]),t._v("温馨提示：课程售出后，不支持退款哦\n    ")])}],n=(a("163d"),a("96cf"),a("3b8d")),r=a("18a0"),o=a.n(r),c={components:{},props:{},data:function(){return{show:!1,flag:!1,couponCode:"",discounts:!1,isShowCouponModel:!1,detail:{bug_info:{}},coupon:{},UPGRADE_SERVICE_AGREEMENT:{},loading:!1}},watch:{},computed:{},methods:{getData:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.$toast.loading({message:"加载中..."}),t.next=3,window.axios.get("/user/upgrade/info",{params:{info_id:this.$route.query.id}});case 3:e=t.sent,a=e.code,s=e.data,i=e.message,0==a?(this.$toast.clear(),this.detail=s):this.$toast.fail(i);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getXiyi:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,window.axios.get("/config/detail",{params:{key:"UPGRADE_SERVICE_AGREEMENT"}});case 2:e=t.sent,a=e.code,s=e.data,i=e.message,0==a?this.UPGRADE_SERVICE_AGREEMENT=s:window.console.log(i);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),confim:function(){1==this.detail.bug_info.protocol_show?this.show=!0:this.createOrder()},confirmXY:function(){this.flag?this.createOrder():this.$toast("请阅读协议并同意协议")},createOrder:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.loading){t.next=2;break}return t.abrupt("return");case 2:return this.$toast.loading({message:"支付中...",forbidClick:!0}),this.loading=!0,t.next=6,window.axios.post("/user/upgrade/order",{upgrade_id:this.detail.bug_info.id});case 6:e=t.sent,a=e.code,s=e.data,i=e.message,this.loading=!1,0==a?this.pay(s.id,s.rose_id):(window.console.error(i),this.$toast.fail(i));case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getDetail:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var a,s,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,window.axios.get("/user/upgrade/order-detail",{params:{order_id:e}});case 2:a=t.sent,s=a.code,i=a.data,n=a.message,0==s?(window.console.log(i),this.$router.push({path:"/webview",query:{url:i.code_url}})):window.console.log(n);case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),pay:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,a){var s,i,n,r,c=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,window.axios.get("/user/upgrade/order-pay?order_id="+e);case 2:s=t.sent,i=s.data,n=s.code,r=s.message,this.$toast.clear(),0==n?o.a.chooseWXPay({timestamp:i.timeStamp,nonceStr:i.nonceStr,package:i.package,signType:i.signType,paySign:i.paySign,success:function(t){c.$toast.success("升级成功"),c.getDetail(e)},fail:function(t){c.$toast.fail("支付失败")}}):this.$toast.fail(r);case 8:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),payTest:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,a){var s,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,window.axios.post("/user/upgrade/order-payed",{order_id:e});case 2:s=t.sent,i=s.code,s.data,n=s.message,0==i?this.getDetail(e):window.console.error(n);case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),getSDK:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=encodeURIComponent(window.location.href),t.next=3,window.axios.get("/config/jsjdk?url="+e);case 3:a=t.sent,s=a.data,i=a.code,0==i&&o.a.config({debug:!1,appId:s.appId,timestamp:Number(s.timestamp),nonceStr:s.nonceStr,signature:s.signature,jsApiList:["chooseWXPay","onMenuShareTimeline","onMenuShareAppMessage","updateAppMessageShareData","updateTimelineShareData"]});case 7:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},created:function(){this.getData(),this.getSDK(),this.getXiyi()},mounted:function(){},filters:{toF:function(t){var e=Number(t);return isNaN(e)?"错误参数":e<0?"0.00":e.toFixed(2)}}},u=c,l=(a("ee00"),a("2877")),d=Object(l["a"])(u,s,i,!1,null,null,null);e["default"]=d.exports},ee00:function(t,e,a){"use strict";var s=a("2ffc"),i=a.n(s);i.a}}]);
//# sourceMappingURL=chunk-71f32490.a5f0b3ef.js.map